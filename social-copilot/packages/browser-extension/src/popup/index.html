<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Social Copilot</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      width: 380px;
      max-width: 100vw;
      max-height: 600px;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 14px;
      color: #333;
      background: #fff;
    }
    .header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 16px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    .header h1 {
      flex: 1;
      font-size: 16px;
      font-weight: 600;
    }
    .tabs {
      display: flex;
      border-bottom: 1px solid #eee;
    }
    .tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      border: none;
      background: none;
      font-size: 13px;
      color: #666;
      transition: all 0.2s;
    }
    .tab:hover {
      background: #f5f5f5;
    }
    .tab.active {
      color: #667eea;
      border-bottom: 2px solid #667eea;
      margin-bottom: -1px;
    }
    .tab-content {
      display: none;
      padding: 16px;
      max-height: 520px;
      overflow-y: auto;
      overscroll-behavior: contain;
    }
    .tab-content.active {
      display: block;
    }
    .status {
      padding: 10px 12px;
      border-radius: 6px;
      margin-bottom: 16px;
      font-size: 13px;
    }
    .status.success {
      background: #e8f5e9;
      color: #2e7d32;
    }
    .status.warning {
      background: #fff3e0;
      color: #e65100;
    }
    .status.info {
      background: #e3f2fd;
      color: #1565c0;
    }
    .form-group {
      margin-bottom: 16px;
    }
    .form-group.inline {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 6px;
    }
    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-weight: 500;
      font-size: 13px;
    }
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 13px;
    }
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
    }
    .form-group small {
      display: block;
      margin-top: 4px;
      color: #999;
      font-size: 11px;
      line-height: 1.35;
    }
    a {
      color: #667eea;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      background: #f3f4ff;
      border: 1px solid #e0e3ff;
      padding: 1px 4px;
      border-radius: 4px;
      word-break: break-all;
    }
    button.primary {
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      transition: opacity 0.2s;
    }
    button.primary:hover {
      opacity: 0.9;
    }
    button.secondary {
      width: 100%;
      padding: 10px;
      background: #f5f5f5;
      color: #333;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 13px;
      cursor: pointer;
      margin-top: 8px;
    }
    button.secondary:hover {
      background: #eee;
    }
    .style-options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .style-option {
      padding: 6px 12px;
      border: 1px solid #ddd;
      border-radius: 16px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .style-option:hover {
      border-color: #667eea;
    }
    .style-option.selected {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    .contact-list {
      max-height: none;
      overflow: visible;
    }
    .contact-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #f0f0f0;
      cursor: pointer;
      flex-direction: column;
      gap: 8px;
    }
    .contact-item:hover {
      background: #f9f9f9;
    }
    .contact-header {
      display: flex;
      align-items: center;
      width: 100%;
      gap: 12px;
    }
    .contact-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 14px;
      margin-right: 12px;
    }
    .contact-info {
      flex: 1;
    }
    .contact-name {
      font-weight: 500;
      font-size: 13px;
    }
    .contact-meta {
      font-size: 11px;
      color: #999;
    }
    .contact-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .reset-pref-btn,
    .clear-memory-btn,
    .clear-contact-btn {
      padding: 6px 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: #fff;
      color: #555;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s;
    }
    .reset-pref-btn:hover,
    .clear-memory-btn:hover,
    .clear-contact-btn:hover {
      border-color: #667eea;
      color: #667eea;
    }
    .empty-state {
      text-align: center;
      padding: 24px;
      color: #999;
    }
    .shortcut-hint {
      margin-top: 16px;
      padding: 12px;
      background: #f9f9f9;
      border-radius: 6px;
      font-size: 12px;
      color: #666;
    }
    .shortcut-hint kbd {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 3px;
      padding: 2px 6px;
      font-family: monospace;
    }
    .style-stats {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      width: 100%;
      padding-left: 48px;
    }
    .memory-box {
      width: 100%;
      padding-left: 48px;
      padding-bottom: 4px;
      font-size: 12px;
      color: #666;
      line-height: 1.5;
    }
    .memory-title {
      font-weight: 600;
      color: #333;
      margin-top: 6px;
      margin-bottom: 2px;
    }
    .memory-text {
      white-space: pre-wrap;
      word-break: break-word;
    }
    .style-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 14px;
      background: #f3f4ff;
      color: #4c51bf;
      font-size: 12px;
      border: 1px solid #e0e3ff;
    }
    .style-pill strong {
      font-weight: 700;
      color: #333;
    }
    .muted {
      color: #999;
      font-size: 12px;
    }
    .hidden {
      display: none;
    }
    .fallback-card {
      padding: 12px;
      border: 1px dashed #d6d9f5;
      border-radius: 10px;
      background: #f7f8ff;
    }
  </style>
</head>
<body>
  <div class="header">
    <span>ğŸ’¬</span>
    <h1>Social Copilot</h1>
  </div>

  <div class="tabs">
    <button class="tab active" data-tab="settings">è®¾ç½®</button>
    <button class="tab" data-tab="contacts">è”ç³»äºº</button>
    <button class="tab" data-tab="about">å…³äº</button>
  </div>

  <!-- è®¾ç½®é¡µ -->
  <div id="settings" class="tab-content active">
    <div id="status" class="status warning">æ­£åœ¨æ£€æŸ¥çŠ¶æ€...</div>

    <div class="fallback-card" style="margin-top: 12px;">
      <div class="form-group" style="margin-bottom: 10px;">
        <label style="font-weight: 600;">éšç§å‘ŠçŸ¥ï¼ˆå¿…é€‰ï¼‰</label>
        <small class="muted">ç”Ÿæˆå»ºè®®æ—¶ä¼šå°†å¿…è¦çš„å¯¹è¯ä¸Šä¸‹æ–‡å‘é€åˆ°ä½ é€‰æ‹©çš„ç¬¬ä¸‰æ–¹æ¨¡å‹æœåŠ¡</small>
      </div>
      <div class="form-group inline" style="margin-bottom: 0;">
        <label for="privacyAcknowledged" style="margin: 0; font-weight: 600;">
          <input type="checkbox" id="privacyAcknowledged">
          æˆ‘å·²ç†è§£å¹¶åŒæ„ä¸Šè¿°è¯´æ˜
        </label>
      </div>
    </div>

    <div class="form-group">
      <label for="provider">æ¨¡å‹æä¾›å•†</label>
      <select id="provider">
        <option value="deepseek">DeepSeek (æ¨è)</option>
        <option value="openai">OpenAI</option>
        <option value="claude">Claude</option>
      </select>
    </div>

    <div class="form-group">
      <label for="baseUrl">Base URLï¼ˆå¯é€‰ï¼‰</label>
      <input type="text" id="baseUrl" placeholder="ä¾‹å¦‚ï¼šhttps://api.deepseek.com" autocomplete="off">
      <small id="baseUrlHint" class="muted">ç•™ç©ºåˆ™ä½¿ç”¨è¯¥æä¾›å•†é»˜è®¤åœ°å€ï¼›æ— éœ€åŒ…å« <code>/v1</code></small>
    </div>

    <div class="form-group">
      <label for="model">æ¨¡å‹åç§°ï¼ˆå¯é€‰ï¼‰</label>
      <input type="text" id="model" placeholder="ä¾‹å¦‚ï¼šdeepseek-v3.2" list="modelSuggestions" autocomplete="off">
      <datalist id="modelSuggestions"></datalist>
      <small id="modelHint" class="muted">ä¸å¡«å†™åˆ™ä½¿ç”¨é»˜è®¤æ¨¡å‹</small>
    </div>

    <div class="form-group">
      <label for="apiKey">API Key</label>
      <input type="password" id="apiKey" placeholder="sk-...">
      <small id="apiKeyHint">
        <a href="https://platform.deepseek.com/" target="_blank" rel="noopener noreferrer">è·å– DeepSeek API Key</a>
      </small>
    </div>

    <div class="form-group inline">
      <label for="persistApiKey" style="margin: 0; font-weight: 600;">
        <input type="checkbox" id="persistApiKey">
        è®°ä½ API Key
      </label>
      <small>ä¸å‹¾é€‰åˆ™å¯†é’¥ä»…æœ¬æ¬¡æµè§ˆå™¨ä¼šè¯æœ‰æ•ˆï¼ˆé‡å¯æµè§ˆå™¨éœ€é‡æ–°è¾“å…¥ï¼‰</small>
    </div>

    <div class="form-group inline">
      <label for="enableMemory" style="margin: 0; font-weight: 600;">
        <input type="checkbox" id="enableMemory">
        å¯ç”¨é•¿æœŸè®°å¿†
      </label>
      <small>åå°ä¼šæç‚¼å¹¶å­˜å‚¨è”ç³»äººæ‘˜è¦ï¼ˆé»˜è®¤å…³é—­ï¼‰</small>
    </div>

    <div class="form-group">
      <label for="language">å›å¤è¯­è¨€</label>
      <select id="language">
        <option value="auto">è‡ªåŠ¨ï¼ˆæ¨èï¼‰</option>
        <option value="zh">ä¸­æ–‡</option>
        <option value="en">English</option>
      </select>
      <small class="muted">é€‰æ‹© auto æ—¶æŒ‰å½“å‰å¯¹è¯è‡ªåŠ¨å†³å®šä¸­/è‹±æ–‡è¾“å‡º</small>
    </div>

    <div class="form-group inline">
      <label for="autoInGroups" style="margin: 0; font-weight: 600;">
        <input type="checkbox" id="autoInGroups">
        ç¾¤èŠè‡ªåŠ¨å¼¹å‡º
      </label>
      <small>é»˜è®¤å…³é—­ï¼›ç¾¤èŠä¸­ä»å¯æŒ‰ Alt+S æ‰‹åŠ¨è§¦å‘</small>
    </div>

    <div class="form-group inline">
      <label for="autoTrigger" style="margin: 0; font-weight: 600;">
        <input type="checkbox" id="autoTrigger" checked>
        æ”¶åˆ°æ¶ˆæ¯è‡ªåŠ¨ç”Ÿæˆå»ºè®®
      </label>
      <small>å…³é—­åä»…å¯æŒ‰ Alt+S æ‰‹åŠ¨è§¦å‘</small>
    </div>

    <div class="fallback-card" style="margin-top: 12px;">
      <div class="form-group" style="margin-bottom: 10px;">
        <label style="font-weight: 600;">éšç§ä¸å‘é€èŒƒå›´</label>
        <small class="muted">ç”¨äºæ§åˆ¶å‘é€ç»™æ¨¡å‹çš„ä¸Šä¸‹æ–‡å¤§å°ä¸è„±æ•ç­–ç•¥ï¼ˆä¸å½±å“æœ¬åœ°å­˜å‚¨ï¼‰</small>
      </div>

      <div class="form-group inline" style="margin-bottom: 10px;">
        <label for="redactPii" style="margin: 0; font-weight: 600;">
          <input type="checkbox" id="redactPii" checked>
          å‘é€å‰è„±æ•ï¼ˆé‚®ç®±/æ‰‹æœºå·/é“¾æ¥ï¼‰
        </label>
      </div>

      <div class="form-group inline" style="margin-bottom: 10px;">
        <label for="anonymizeSenders" style="margin: 0; font-weight: 600;">
          <input type="checkbox" id="anonymizeSenders" checked>
          ä¸å‘é€æ˜µç§°ï¼ˆç”¨ã€Œæˆ‘/å¯¹æ–¹ã€æ›¿ä»£ï¼‰
        </label>
      </div>

      <div class="form-group">
        <label for="contextMessageLimit">å‘é€æœ€è¿‘æ¶ˆæ¯æ¡æ•°</label>
        <input type="number" id="contextMessageLimit" min="1" max="50" placeholder="10">
        <small class="muted">ä»…å½±å“å‘é€ç»™æ¨¡å‹çš„ä¸Šä¸‹æ–‡ï¼ˆå½“å‰æ¶ˆæ¯å§‹ç»ˆåŒ…å«ï¼‰</small>
      </div>

      <div class="form-group">
        <label for="maxCharsPerMessage">å•æ¡æ¶ˆæ¯æœ€å¤§å­—ç¬¦æ•°</label>
        <input type="number" id="maxCharsPerMessage" min="50" max="4000" placeholder="500">
      </div>

      <div class="form-group" style="margin-bottom: 0;">
        <label for="maxTotalChars">ä¸Šä¸‹æ–‡æ€»å­—ç¬¦é¢„ç®—</label>
        <input type="number" id="maxTotalChars" min="200" max="20000" placeholder="4000">
      </div>
    </div>

    <div class="form-group inline">
      <label for="enableFallback" style="margin: 0; font-weight: 600;">
        <input type="checkbox" id="enableFallback">
        å¯ç”¨å¤‡ç”¨æ¨¡å‹
      </label>
      <small>ä¸»æ¨¡å‹å¼‚å¸¸æ—¶è‡ªåŠ¨åˆ‡æ¢</small>
    </div>

    <div id="fallbackFields" class="fallback-card hidden">
      <div class="form-group">
        <label for="fallbackProvider">å¤‡ç”¨æ¨¡å‹</label>
        <select id="fallbackProvider">
          <option value="deepseek">DeepSeek</option>
          <option value="openai">OpenAI</option>
          <option value="claude">Claude</option>
        </select>
      </div>

      <div class="form-group">
        <label for="fallbackBaseUrl">å¤‡ç”¨ Base URLï¼ˆå¯é€‰ï¼‰</label>
        <input type="text" id="fallbackBaseUrl" placeholder="ä¾‹å¦‚ï¼šhttps://api.deepseek.com" autocomplete="off">
        <small id="fallbackBaseUrlHint" class="muted">ç•™ç©ºåˆ™ä½¿ç”¨è¯¥æä¾›å•†é»˜è®¤åœ°å€ï¼›æ— éœ€åŒ…å« <code>/v1</code></small>
      </div>

      <div class="form-group">
        <label for="fallbackModel">å¤‡ç”¨æ¨¡å‹åç§°ï¼ˆå¯é€‰ï¼‰</label>
        <input type="text" id="fallbackModel" placeholder="ä¾‹å¦‚ï¼šdeepseek-r1-0528" list="fallbackModelSuggestions" autocomplete="off">
        <datalist id="fallbackModelSuggestions"></datalist>
        <small id="fallbackModelHint" class="muted">ä¸å¡«å†™åˆ™ä½¿ç”¨è¯¥æä¾›å•†é»˜è®¤æ¨¡å‹</small>
      </div>

      <div class="form-group">
      <label for="fallbackApiKey">å¤‡ç”¨ API Key</label>
      <input type="password" id="fallbackApiKey" placeholder="sk-...">
      <small id="fallbackApiKeyHint">
          <a href="https://platform.deepseek.com/" target="_blank" rel="noopener noreferrer">è·å– DeepSeek API Key</a>
        </small>
      </div>
    </div>

    <div class="form-group">
      <label>é»˜è®¤å›å¤é£æ ¼</label>
      <div class="style-options">
        <span class="style-option selected" data-style="caring">ğŸ’— å…³å¿ƒ</span>
        <span class="style-option selected" data-style="humorous">ğŸ˜„ å¹½é»˜</span>
        <span class="style-option selected" data-style="casual">ğŸ˜Š éšæ„</span>
        <span class="style-option" data-style="rational">ğŸ§  ç†æ€§</span>
        <span class="style-option" data-style="formal">ğŸ“ æ­£å¼</span>
      </div>
    </div>

    <div class="form-group">
      <label for="suggestionCount">æ¯æ¬¡æ˜¾ç¤ºçš„å›å¤æ•°é‡</label>
      <select id="suggestionCount">
        <option value="3">3 æ¡ï¼ˆé»˜è®¤ï¼‰</option>
        <option value="2">2 æ¡</option>
      </select>
      <small class="muted">å½±å“æ¯æ¬¡ç”Ÿæˆçš„å›å¤å»ºè®®æ¡æ•°</small>
    </div>

    <button id="saveBtn" class="primary">ä¿å­˜è®¾ç½®</button>

    <div class="shortcut-hint">
      ğŸ’¡ å¿«æ·é”®ï¼šæŒ‰ <kbd>Alt</kbd> + <kbd>S</kbd> æ‰‹åŠ¨è§¦å‘å»ºè®®
    </div>
  </div>

  <!-- è”ç³»äººé¡µ -->
  <div id="contacts" class="tab-content">
    <div id="contactList" class="contact-list">
      <div class="empty-state">æš‚æ— è”ç³»äººè®°å½•</div>
    </div>
  </div>

  <!-- å…³äºé¡µ -->
  <div id="about" class="tab-content">
    <div class="status info">
      <strong id="aboutVersion">Social Copilot</strong><br>
      AI è¾…åŠ©ç¤¾äº¤ä¼´ä¾£
    </div>
    <p style="font-size: 13px; color: #666; line-height: 1.6;">
      ä¸ºèŠå¤©åº”ç”¨æä¾›æ™ºèƒ½å›å¤å»ºè®®ï¼Œæ”¯æŒ Telegram Webã€WhatsApp Webã€Slack Webã€‚
    </p>
    <p style="font-size: 13px; color: #666; line-height: 1.6; margin-top: 12px;">
      æ‰€æœ‰æ•°æ®é»˜è®¤å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¿æŠ¤æ‚¨çš„éšç§ã€‚
    </p>
    <p style="font-size: 13px; color: #666; line-height: 1.6; margin-top: 12px;">
      æç¤ºï¼šç”Ÿæˆå›å¤æ—¶ä¼šå°†â€œå¿…è¦çš„å¯¹è¯ä¸Šä¸‹æ–‡â€å‘é€åˆ°ä½ é€‰æ‹©çš„ç¬¬ä¸‰æ–¹æ¨¡å‹æœåŠ¡ï¼›å¯åœ¨è®¾ç½®é¡µçš„ã€Œéšç§ä¸å‘é€èŒƒå›´ã€ä¸­é…ç½®è„±æ•/åŒ¿ååŒ–ä¸å‘é€ä¸Šé™ã€‚
    </p>
    <p style="font-size: 12px; color: #888; line-height: 1.6; margin-top: 8px;">
      ä¸Šæ¶å‘å¸ƒæ—¶å»ºè®®æä¾›å…¬å¼€çš„éšç§æ”¿ç­– URLï¼ˆæ¨¡æ¿è§é¡¹ç›®æ–‡æ¡£ `docs/PRIVACY.md`ï¼‰ã€‚
    </p>

    <div class="fallback-card" style="margin-top: 12px;">
      <div class="form-group" style="margin-bottom: 10px;">
        <label style="font-weight: 600;">å¤‡ä»½ä¸æ¢å¤</label>
        <small class="muted">å¯¼å‡º/å¯¼å…¥è”ç³»äººç”»åƒã€é£æ ¼åå¥½ä¸é•¿æœŸè®°å¿†ï¼ˆä¸åŒ…å« API Keyï¼Œä¹Ÿä¸åŒ…å«åŸæ–‡å¯¹è¯æ¶ˆæ¯ï¼‰ã€‚</small>
      </div>
      <button id="exportUserDataBtn" class="secondary">å¯¼å‡ºæ•°æ®å¤‡ä»½</button>
      <button id="importUserDataBtn" class="secondary">å¯¼å…¥æ•°æ®å¤‡ä»½</button>
      <input id="importUserDataFile" class="hidden" type="file" accept="application/json">
      <small class="muted">æ³¨æ„ï¼šå¤‡ä»½æ–‡ä»¶åŒ…å«æœ¬åœ°ç”»åƒ/è®°å¿†ç­‰éšç§ä¿¡æ¯ï¼Œè¯·å¦¥å–„ä¿ç®¡ã€‚</small>
    </div>

    <button id="clearDataBtn" class="secondary">æ¸…é™¤æ‰€æœ‰æ•°æ®</button>

    <div class="fallback-card" style="margin-top: 12px;">
      <div class="form-group inline" style="margin-bottom: 10px;">
        <label for="debugEnabled" style="margin: 0; font-weight: 600;">
          <input type="checkbox" id="debugEnabled">
          å¯ç”¨è¯Šæ–­æ—¥å¿—
        </label>
        <small class="muted">è®°å½•æœ€è¿‘è¯·æ±‚ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜</small>
      </div>
      <button id="copyDiagnosticsBtn" class="secondary">å¤åˆ¶è¯Šæ–­ä¿¡æ¯</button>
      <button id="downloadDiagnosticsBtn" class="secondary">ä¸‹è½½è¯Šæ–­ JSON</button>
      <button id="clearDiagnosticsBtn" class="secondary">æ¸…ç©ºè¯Šæ–­æ—¥å¿—</button>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
